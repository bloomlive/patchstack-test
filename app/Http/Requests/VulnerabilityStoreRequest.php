<?php

namespace App\Http\Requests;

use App\Rules\VulnerabilitiesTypeExistsAsKeyRule;
use Illuminate\Foundation\Http\FormRequest;

class VulnerabilityStoreRequest extends FormRequest
{
    public function rules(): array
    {
        return [
            'title'                      => ['required', 'string'],
            'excerpt'                    => ['required', 'string', 'max:65535'],
            'description'                => ['required', 'string', 'max:4294967295'],
            'vulnerability_type_value'   => [
                'required',
                'array',
                'min:9',
                'max:9',
                new VulnerabilitiesTypeExistsAsKeyRule
            ],
            'vulnerability_type_value.*' => ['required', 'numeric'],
        ];
    }
}
